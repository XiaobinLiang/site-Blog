<!DOCTYPE HTML>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Maverick,熊猫小A,Galileo,blog" />
    <meta name="generator" content="Maverick 1.1" />
    <meta name="template" content="Prism" />
    <link rel="alternate" type="application/rss+xml" title="无文字 | 三无计划 &raquo; RSS 2.0" href="/feed/index.xml" />
    <link rel="alternate" type="application/atom+xml" title="无文字 | 三无计划 &raquo; ATOM 1.0" href="/feed/atom/index.xml" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/assets/prism-561767ec37.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/assets/ExSearch/ExSearch-182e5a8869.css">
    <link href="https://fonts.googleapis.com/css?family=Fira+Code&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
    <script>
        var ExSearchConfig = {
            root: "",
            api: "https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/993aa3dcb70943b3e506b13b3d502541.json"
        }

    </script>
    
<title>无文字 | 三无计划</title>
<meta name="author" content="熊猫小A" />
<meta name="description" content="只坚持一种正义。我的正义。" />
<meta property="og:title" content="无文字 | 三无计划" />
<meta property="og:description" content="只坚持一种正义。我的正义。" />
<meta property="og:site_name" content="无文字 | 三无计划" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/page/5/" />
<meta property="og:image" content="无文字 | 三无计划" />
<meta name="twitter:title" content="无文字 | 三无计划" />
<meta name="twitter:description" content="只坚持一种正义。我的正义。" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/android-chrome-512x512.png" />


    
<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="//cdn.jsdelivr.net" />
<link rel="dns-prefetch" href="//blog.imalan.cn" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/brand_font/embed.css" />
<style>.brand{font-family:FZCuJinLFW,serif;font-weight: normal!important;}</style>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="apple-touch-icon" sizes="180x180" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/apple-touch-icon.png?v=PY43YeeEKx">
<link rel="icon" type="image/png" sizes="32x32" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/favicon-32x32.png?v=yyLyaqbyRG">
<link rel="icon" type="image/png" sizes="16x16" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/favicon-16x16.png?v=yyLyaqbyRG">
<link rel="mask-icon" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/safari-pinned-tab.svg?v=yyLyaqbyRG" color="#505050">
<link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/favicon.ico?v=yyLyaqbyRG">
<meta name="application-name" content="三無計劃">
<meta name="apple-mobile-web-app-title" content="三無計劃">
<meta name="msapplication-TileColor" content="#000000">
<meta name="theme-color" content="#000000">
<meta name="baidu-site-verification" content="9BEwwo6Ibg" />

</head>

<body>
    <div class="container prism-container">
        <header class="prism-header" id="prism__header">
            <h1 class="text-uppercase"><a class="no-link" href="/" target="_self">无文字 | 三无计划</a></h1>
            <p>只坚持一种正义。我的正义。</p>
            <nav class="prism-nav"><ul><li><a class="no-link text-uppercase " href="/" target="_self">首页</a></li><li><a class="no-link text-uppercase " href="/archives/" target="_self">归档</a></li><li><a class="no-link text-uppercase " href="/links/" target="_self">友链</a></li><li><a class="no-link text-uppercase " href="/about/" target="_self">关于</a></li><li><a href="#" target="_self" class="search-form-input no-link text-uppercase">搜索</a></li></ul></nav>
        </header>
        <div class="prism-wrapper" id="prism__wrapper">
            
<main>    
    

<section id="prism__post-list" class="prism-section row">
    
    <article class="yue prism-post-item col-md-8 offset-md-2">
        <h1 class="prism-post-title"><a class="no-link" href="/archives/225/" target="_self">2018：宅、然后继续温柔地反抗吧</a></h1>
        <div class="prism-post-time">
            <a class="no-link" href="/archives/225/" target="_self">
                <time class="text-uppercase">
                    December 24 2018
                </time>
            </a>
        </div>
        <div class="prism-content"><p>有时候觉得写总结文章很可怕，往往回头一看，又是碌碌无为的一年。但是，2018 于我而言恐怕确实有总结的必要，因为在平淡的四年后，生活总算有了变化。</p>
<p>年初，寒假尚未结束就匆匆返校，为毕业设计做准备。进入大四下，按理说已经没有课了，全力应付毕设就好，但我因为保研的原因可提前选修研究生的课程。我便挑选了几门看上去只需花时间即可的课程，为大四下多加了一些课业负担。</p>
<p>那是最黄金的时间。一切都是自由的。我可以选择看论文，敲代码，或者读书看番，基本上全由自己掌握。同时我也有机会去发展自己的爱好，做一些有趣的尝试。</p>
<p>虽说学院对毕设看得很重，要求也相当严格，但一切都很顺利。</p>
<hr>
<p>暑假是我的一个遗憾，因为没能出去走走。而这也许是我能自在逍遥的最后一个暑假。</p>
<p>「世界」一词，「世」是时间，「界」是空间。我们称其为「宅」的人，多是说他在空间上爱出没于一处：他最舒适的一处。我是希望体验整个世界的，因此我不喜「宅」所蕴含的空间属性。但我喜欢「宅」所蕴含的精神属性，后文再谈。</p>
<p>此后迎来的是「奋进的暑假」，在往日的<a href="https://blog.imalan.cn/archives/139/">文章</a>中有所提及。另外，同任何一次减肥的决定一样，在年末的现在，失败了（笑）。若有另一个我在看着我，他应该不会喜欢我，因为我不喜欢无法贯彻自己理念的人。正因如此，减肥的尝试仍然会继续。</p>
<hr>
<p>这个暑假的重要之处不是这次失败的减肥尝试。正是在这个暑假里，我重新开始阅读了。</p>
<p>我原来是很喜欢阅读的，但入高中以后，就难以静心读书了；进入大学，更加自由，分心的东西更多，读书越发不可能。这个暑假里，吃住在作坊，有师长在一旁，不敢大张旗鼓地看剧，索性买书来读。</p>
<p>阅读能够带来什么呢？其实我读过的许多书，内容都记不不清楚了。我不敢说我从阅读中得到了多少知识上的裨益。阅读主要带给我的是专注的能力。</p>
<p>现代人都很擅长 multi-tasking，这是不得已而为之的。久而久之，就真的丧失了专注地做一件事的能力。然而我认为这是不好的，大脑在不同的 context 之间切换需要消耗能量。注意力是消耗品，必须将它花在合理的地方。</p>
<p>我（重新）开始认真地读书，认真地看电影，认真地听音乐，认真地体会「世界」。因此变得越发细腻。许多事物原来只有模糊的轮廓，如今在我的脑海中清晰起来。我还小时，父亲让我在街上观察形形色色的人，看他们的穿着，举止，言行，让我从中推断别的事情，当时我觉得很难。现在想起来，无非是专注的能力不够。不够专注，注意力就容易涣散，便抓不住事物的精髓。</p>
<p>话说到这里，那么足够专注之后的自己，变成什么了呢？</p>
<p>「宅」。</p>
<p>我觉得应该将「废柴」这一物种从宅人中剔除出去，因为我认同的「宅」不但不废，恐怕比任何人都有能量得多。若一个人对某事物达到了癫狂的地步，英文称之为 maniac，中文即可称之为「宅」。这是「宅」的精神内涵。</p>
<p><a href="https://www.wikiwand.com/en/Marco_Arment">Marco Arment</a> 宅吗？<a href="https://www.wikiwand.com/en/Ryuichi_Sakamoto">坂本龙一</a>宅吗？他们宅得不能再宅了。程序员尤其需要「宅」，这便是我在 2018 后半年的行动纲领。闭门造车，出门合辙。</p>
<p>开学以来一直在忙活实验室的一个项目，是单纯的编码工作。同时在业余也写一些练手的东西，包括 RAW 这个主题（以及许多已经放弃的主题）。</p>
<p>对（非工业化的）编程来说，其实程序员就是神的角色。为这个世界奠基，为这个世界制定规则，为这个世界添砖加瓦。因此需要高度的专注，总揽全局。这种感觉也是让我上瘾的地方。做博客就是一个实例；为自己的博客编写主题，甚至重写后端，是进阶。</p>
<hr>
<p>若要我为 2018 选一个汉字，我会选「变」字。无论是用在我自己身上，还是用在这个世界上，都可以。从三月的<a href="https://zh.wikipedia.org/zh-hans/%E4%B8%AD%E5%8D%8E%E4%BA%BA%E6%B0%91%E5%85%B1%E5%92%8C%E5%9B%BD%E5%AE%AA%E6%B3%95%E4%BF%AE%E6%AD%A3%E6%A1%88_(2018%E5%B9%B4)">修宪</a>，到层出不穷的社会事件，以及至年末时接二连三的名人去世，都在提醒我，这个世界是变化的，而且变得比我想象的要快。</p>
<p>异变中，有许多我认为不合理的事情。不合理的事情出现得越来越频繁了，我不怕它们出现，我怕的是人们对坏事习以为常。前段时间，博友在<a href="https://www.wikimoe.com/?post=204">博客</a>抱怨外卖不净，我在下面评论：</p>
<blockquote><p>有许多人喜欢自嘲说在中国毒空气毒操场毒奶粉都习惯了，中国人已经百毒不侵。
我不太喜欢这类抖机灵，相似的还有提起Google、Twitter就说“不存在的网站”一样。
我总觉得这些明显不合理的事情出现了，我们不应该去适应它们，而应该反抗它们。</p>
</blockquote>
<p>这其实也是我在 2018 年的一个变化：外面变得温和，但恐怕内里变得更尖锐了。相比起前几年，我已经习惯不在朋友圈做太多的时事评论，转而在行为上抗拒我不认同的一切。<a href="https://blog.imalan.cn/archives/94/">我似乎有点一条道儿走到黑了</a>。</p>
<hr>
<p>我很开心，度过了非凡的一年。但遗憾的是，读的书还不够多，看的电影还不够多，听的音乐还不够多，写的代码还不够多。</p>
<p>这一年我真实地感觉到了时间不够用。一天 24 小时，根本不够完成自己想要做的事，这才明白找准方向的重要性。随着时间流逝，试错的机会越来越少，必须抓紧时间了。继续专注，继续不妥协，继续用心感受世界，继续那些不切实际的幻想：这是进入 2019 之际我对自己的嘱咐。</p>
<p>「宅」，然后继续温柔地反抗吧。</p>
<hr>
<p>2019-03-10 修订：「抵抗」改为「反抗」。</p>
</div>
        
        <div class="prism-action-bar">
            <div class="comment-action action-item"><a class="no-link text-uppercase" href="/archives/225/#prism__comment" target="_self"><i class="fa fa-comment"></i>评论</a></div>
        </div>
        
    </article>
    
    <article class="yue prism-post-item col-md-8 offset-md-2">
        <h1 class="prism-post-title"><a class="no-link" href="/archives/219/" target="_self">RSA 算法介绍与 DEMO</a></h1>
        <div class="prism-post-time">
            <a class="no-link" href="/archives/219/" target="_self">
                <time class="text-uppercase">
                    December 15 2018
                </time>
            </a>
        </div>
        <div class="prism-content"><h2>引言</h2>
<p>RSA 算法是一种常用的非对称加密算法，它的加密基础是对大数做因数分解的困难程度。虽然其安全性尚没有在理论上被证明，但在秘钥长度足够（1024 位以上）时，以目前发现的破解方法来看成本难以承受，因此可以认为是安全的。本文简要介绍了对称加密算法、非对称加密算法，然后罗列了 RSA 算法的实现步骤，最后给出一个 C++ 编写的 Demo。</p>
<blockquote><p>注意，文中略去了大部分的数学证明过程；另外 Demo 仅用于帮助理解算法，几乎<strong>不能</strong>应用在任何实际场景中。</p>
</blockquote>
<h2>对称加密与非对称加密</h2>
<p>假设 A 要将一则消息传递给 B，却不想让任何第三方人员得知消息内容，这就需要对消息进行加密。借用经典的「箱子-钥匙」的比喻，只需要制造一个箱子，并为之配两把钥匙，A、B 各执一把，即可完成对消息的保密过程。步骤是：A 使用钥匙将消息放在箱子里锁住并发送给 B，B 收到后再使用手上的钥匙打开箱子获得消息的原文。这种加密方法简单易用，但是面临秘钥分发的问题：如何让 A、B 都有一样的钥匙呢？传递钥匙的过程本身就面临着泄露的风险，为了克服这个问题（以及其他的一些问题），非对称加密上场了。</p>
<p>非对称加密中，秘钥是成对的：一个公钥，一个私钥，二者不同。公钥可以广而告之，任何人都能拿到，但是私钥只能由接收信息的一方自己保存。一个非对称加密算法总是想要实现这么一个效果：任何想要发送信息的人都必须使用<strong>接收方所提供</strong>的公钥对信息进行加密得到密文，接收方收到密文后再用自己的私钥对其解密得到原文。在整个过程中，私钥没有被传递，因此解决了秘钥分发的问题。</p>
<p>RSA 算法就是一种非对称加密算法，接下来对其进行简要介绍。</p>
<h2>RSA 算法原理</h2>
<p>RSA 算法的步骤如下：</p>
<ol>
<li><p>首先选取两个不相同的大质数 $p$ 与 $q$，计算 $N=p\times q$；</p>
</li>
<li><p>然后求欧拉函数 $r=(p-1)\times (q-1)$；</p>
</li>
<li><p>选择一个数 $e$，$0<e<r$，且 $e$ 与 $r$ 互质，求 $e$ 关于 $r$ 的模反元素 $d$，即此方程中 $d$ 的非负整数解: $e\times d+r\times y=1$。</p>
</li>
</ol>
<p>则得到了公钥 $(N,e)$ 与私钥 $(N,d)$。</p>
<p>若要对数 $x$ 进行加密，只需要按照此方法计算密文：</p>
<p>$$encrypt=x^{e}\quad Mod\quad N$$</p>
<p>由密文计算原文的方式是很类似的：</p>
<p>$$decrypt=encrypt^{d}\quad Mod\quad N$$</p>
<p>需要注意的是，加密的密文长度不能超过 $N$，但是如果 $N$ 选得过大，又会使得计算速度减慢，因此 RSA 算法还是更适合小规模数据的加密。</p>
<p>RSA 有效的基础是从 $N$ 与 $e$ 反推 $p$ 与 $q$ 是很困难的，一般选取的 $N$ 的位数高达 1024。</p>
<h2>一个 Demo</h2>
<p>RSA 算法过程是很明了的，但是如果真的按照理论步骤直接写……你会发现并不可行，这是由于涉及到的幂次运算数字非常大，不可能直接完成。</p>
<p>下面的 Demo 给出了一个示例。其中 <code>exp_mod()</code> 方法值得注意，它降低了加解密过程的计算量。</p>
<div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>

<span class="c1">// 扩展欧拉定理，求私钥</span>
<span class="kt">long</span> <span class="nf">gcdEx</span><span class="p">(</span><span class="kt">long</span> <span class="n">a</span><span class="p">,</span> <span class="kt">long</span> <span class="n">b</span><span class="p">,</span> <span class="kt">long</span> <span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="kt">long</span> <span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="o">*</span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">a</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="kt">long</span> <span class="n">r</span> <span class="o">=</span> <span class="n">gcdEx</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="o">%</span><span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
        <span class="kt">long</span> <span class="n">t</span> <span class="o">=</span> <span class="o">*</span><span class="n">x</span><span class="p">;</span>
        <span class="o">*</span><span class="n">x</span> <span class="o">=</span> <span class="o">*</span><span class="n">y</span><span class="p">;</span>
        <span class="o">*</span><span class="n">y</span> <span class="o">=</span> <span class="n">t</span> <span class="o">-</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span> <span class="o">*</span> <span class="o">*</span><span class="n">y</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 计算公钥 (n,e) 与私钥 (n,d)</span>
<span class="kt">void</span> <span class="nf">GenKey</span><span class="p">(</span><span class="kt">long</span> <span class="n">p</span><span class="p">,</span> <span class="kt">long</span> <span class="n">q</span><span class="p">,</span> <span class="kt">long</span><span class="o">&amp;</span> <span class="n">n</span><span class="p">,</span> <span class="kt">long</span><span class="o">&amp;</span> <span class="n">e</span><span class="p">,</span> <span class="kt">long</span><span class="o">&amp;</span> <span class="n">d</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">e</span> <span class="o">=</span> <span class="mi">19</span><span class="p">;</span>  <span class="c1">// 一般选择 65537</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="p">;</span>    <span class="c1">// 与 e 构成公钥</span>
    <span class="kt">long</span> <span class="n">fn</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
    <span class="kt">long</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span>
    <span class="n">gcdEx</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">);</span>

    <span class="c1">// 保证 x 为正数</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">+=</span> <span class="n">fn</span><span class="p">;</span>

    <span class="n">d</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 计算求幂后取模的值 (base^e) mod m</span>
<span class="kt">long</span> <span class="nf">exp_mod</span><span class="p">(</span><span class="kt">long</span> <span class="n">base</span><span class="p">,</span> <span class="kt">long</span> <span class="n">e</span><span class="p">,</span> <span class="kt">long</span> <span class="n">m</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">nRet</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">nMaxBit</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">nMax</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

    <span class="c1">// 获取b的最高有效位</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">nMax</span> <span class="o">&lt;</span> <span class="n">e</span><span class="p">){</span>
        <span class="n">nMax</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="o">++</span><span class="n">nMaxBit</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// 求模 </span>
    <span class="k">for</span> <span class="p">(</span><span class="n">N</span> <span class="o">=</span> <span class="n">nMaxBit</span><span class="p">;</span> <span class="n">N</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="o">--</span><span class="n">N</span><span class="p">){</span>
        <span class="n">nRet</span> <span class="o">=</span> <span class="p">(</span><span class="n">nRet</span> <span class="o">*</span> <span class="n">nRet</span><span class="p">)</span> <span class="o">%</span> <span class="n">m</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">e</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">N</span><span class="p">)){</span>
            <span class="n">nRet</span> <span class="o">=</span> <span class="p">(</span><span class="n">nRet</span> <span class="o">*</span> <span class="n">base</span><span class="p">)</span> <span class="o">%</span> <span class="n">m</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">nRet</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">long</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">127</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">131</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">n</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">d</span><span class="p">;</span>

    <span class="c1">// 生成密钥对</span>
    <span class="n">GenKey</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">d</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> 
        <span class="o">&lt;&lt;</span> <span class="s">&quot;e: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;n: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">n</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;d: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">d</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>

    <span class="kt">long</span> <span class="n">text</span> <span class="o">=</span> <span class="mi">12345</span><span class="p">;</span>

    <span class="c1">// 加密</span>
    <span class="kt">long</span> <span class="n">encrypted</span> <span class="o">=</span> <span class="n">exp_mod</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;encrypted: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">encrypted</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>

    <span class="c1">// 解密</span>
    <span class="kt">long</span> <span class="n">decrypted</span> <span class="o">=</span> <span class="n">exp_mod</span><span class="p">(</span><span class="n">encrypted</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;decrypted: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">decrypted</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
        
        <div class="prism-action-bar">
            <div class="comment-action action-item"><a class="no-link text-uppercase" href="/archives/219/#prism__comment" target="_self"><i class="fa fa-comment"></i>评论</a></div>
        </div>
        
    </article>
    
    <article class="yue prism-post-item col-md-8 offset-md-2">
        <h1 class="prism-post-title"><a class="no-link" href="/archives/216/" target="_self">A* 算法求解十五数码问题</a></h1>
        <div class="prism-post-time">
            <a class="no-link" href="/archives/216/" target="_self">
                <time class="text-uppercase">
                    November 25 2018
                </time>
            </a>
        </div>
        <div class="prism-content"><h2>问题描述</h2>
<p>数码问题是一类比较经典的图搜索问题，它给定如下表所示的某个初始状态（这里以 4*4 的十五数码问题为例）：</p>
<table>
<thead><tr>
<th>11</th>
<th>9</th>
<th>4</th>
<th>15</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>3</td>
<td>0</td>
<td>12</td>
</tr>
<tr>
<td>7</td>
<td>5</td>
<td>8</td>
<td>6</td>
</tr>
<tr>
<td>13</td>
<td>2</td>
<td>10</td>
<td>14</td>
</tr>
</tbody>
</table>
<p>每次可将 0 上下左右移动一格，要求寻找某个移动策略，使整个局面达到目标状态，例如：</p>
<table>
<thead><tr>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
</tr>
<tr>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr>
<td>13</td>
<td>14</td>
<td>15</td>
<td>0</td>
</tr>
</tbody>
</table>
<h2>算法描述</h2>
<h3>一般图搜索算法</h3>
<p>视每种状态为一个节点。在某节点下，通过移动 0  的位置可以得到新的节点，这称为“扩展一个节点”。理论上讲，整个牌局可能出现的局面数，也就是节点数是有穷的，因此通过暴力搜索肯定能找到解（若有解的话）。但是 15 数码问题局面总数是 16!，这使暴力搜索没有实践价值。</p>
<p>一般的图搜索算法通过维护两个表：OPEN 表与 CLOSE 表，分别存放未被扩展过的节点与已经被扩展过的节点，并通过某种策略来优化搜索过程。其基本过程是：</p>
<ol>
<li>将初始状态加入 OPEN 表，清空 CLOSE 表</li>
<li>若 OPEN 表为空，失败，退出</li>
<li>移除 OPEN 表中的第一个节点，将其加入 CLOSE 表，该节点记为 n</li>
<li>若 n 是目标节点，搜索成功，退出</li>
<li>扩展 n 节点，舍弃扩展出的子节点中与 n 的父节点相同的节点，对剩下的子节点做如下处理：<ul>
<li>若该子节点不在 OPEN 表与 CLOSE 表中，则将其加入 OPEN 表</li>
<li>否则，记与该子节点相同的已存在的节点为 P，舍弃该子节点，按照<strong>某种原则</strong>判断是否应该修改 P 的父节点指向</li>
</ul>
</li>
<li>按照<strong>某种原则</strong>重排 OPEN 表</li>
<li>跳转至第二步</li>
</ol>
<p>这个过程给出了图搜索算法的一般流程。在进行算法实现时还需要指定重排 OPEN 表的准则：也就是确定哪些节点应该被优先扩展与留在搜索树中。</p>
<h3>A 算法</h3>
<p>A 算法通过一个估价函数 f 来对节点进行评价，估计出该节点到达目标节点的“希望”，并有限扩展最有希望的节点。其估价函数定义为：
$$
f(n)=g(n)+h(n)
$$
其中 n 代表被评价的节点。特别的，定义
$$
g^*(n)：从起始节点到n的最优路径的代价
$$</p>
<p>$$
h^*(n)：从n到目标节点的最优路径的代价
$$</p>
<p>$$
f^*(n)：从起始节点到目标节点的最优路径的代价
$$</p>
<p>因此 $f(n),g(n),h(n)$ 是 $f^*(n),g^*(n),h^*(n)$ 的估计值。一般选择 $g(n)$ 为起始节点到 n 的实际代价，$h(n)$ 为 n 到目标节点的代价估计。$h(n)$ 是基于某准则制定的启发函数，用于描述 n 到目标节点的“难度”。</p>
<p>在一般图搜索算法的第 6 步，A 算法对 OPEN 表中的所有节点使用 $f(n)$ 进行评价并由小到大排序，每次都有限扩展 $f(n)$ 最小的节点。另外在第 5 步，当 P 已存在时，若新生成的子节点的 $f(n)$ 相对 P 的更小，则更新 P 的父节点为当前节点，并递归地更新 P 的所有子节点的估价。</p>
<h3>A* 算法</h3>
<p>在 A 算法中，若有
$$
h(n)\leq h^<em>(n)
$$
则称为 A</em> 算法。</p>
<h2>算法实现</h2>
<p>这里使用 C++ 进行算法实现。设初始与目标状态为问题描述中的两个表。选取 $h(n)$ 为当前节点中所有数码相对目标位置的曼哈顿距离和。</p>
<h3>节点类</h3>
<div class="highlight"><pre><span></span><span class="k">extern</span> <span class="kt">int</span> <span class="n">start</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">target</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">trans</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span>

<span class="k">class</span> <span class="nc">node</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="kt">int</span> <span class="n">m_State</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">m_Zero</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>    
    <span class="n">node</span><span class="o">*</span> <span class="n">m_Parent</span><span class="p">;</span>  
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">node</span><span class="o">*&gt;</span> <span class="n">m_Childern</span><span class="p">;</span>   
    <span class="kt">int</span> <span class="n">m_H</span><span class="p">;</span> <span class="c1">// 代价    </span>
    <span class="kt">int</span> <span class="n">m_G</span><span class="p">;</span> <span class="c1">// 深度</span>

    <span class="n">node</span><span class="p">();</span>
    <span class="n">node</span><span class="p">(</span><span class="kt">int</span> <span class="n">from</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]);</span>
    <span class="n">node</span><span class="p">(</span><span class="kt">int</span> <span class="n">from</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span> <span class="n">node</span><span class="o">*</span> <span class="n">parent</span><span class="p">);</span>

    <span class="kt">void</span> <span class="nf">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">from</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]);</span>
    <span class="kt">void</span> <span class="nf">calcH</span><span class="p">();</span>
    <span class="kt">void</span> <span class="nf">calcG</span><span class="p">();</span>
    <span class="k">static</span> <span class="kt">void</span> <span class="nf">findZero</span><span class="p">(</span><span class="kt">int</span> <span class="n">state</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span><span class="kt">int</span> <span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
    <span class="kt">void</span> <span class="nf">findZero</span><span class="p">();</span>
    <span class="kt">int</span> <span class="nf">getPrice</span><span class="p">();</span>
    <span class="kt">void</span> <span class="nf">expand</span><span class="p">();</span>
    <span class="kt">bool</span> <span class="nf">check</span><span class="p">(</span><span class="kt">int</span> <span class="n">t</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]);</span>

    <span class="c1">// 重载操作符，判定节点是否等价</span>
    <span class="kt">bool</span> <span class="k">operator</span><span class="o">==</span><span class="p">(</span><span class="n">node</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">check</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">m_State</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">bool</span> <span class="k">operator</span><span class="o">==</span><span class="p">(</span><span class="kt">int</span> <span class="n">t</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">check</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="kt">void</span> <span class="nf">print</span><span class="p">(</span><span class="kt">int</span> <span class="n">t</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]);</span>
<span class="kt">int</span> <span class="nf">output</span><span class="p">(</span><span class="n">node</span><span class="o">*</span> <span class="n">n</span><span class="p">);</span>
<span class="n">node</span><span class="o">*</span> <span class="nf">findP</span><span class="p">(</span><span class="kt">int</span> <span class="n">t</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]);</span>
<span class="n">node</span><span class="o">*</span> <span class="nf">get</span><span class="p">();</span>
<span class="kt">void</span> <span class="nf">updateAll</span><span class="p">(</span><span class="n">node</span><span class="o">*</span> <span class="n">n</span><span class="p">);</span>
</pre></div>
<p>大部分成员及方法这里只给出声明，实现见附件中的 node.cpp。其中的 <code>expand()</code> 方法值得注意：</p>
<div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">trans</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="p">{</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span> <span class="p">},{</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span> <span class="p">},{</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span> <span class="p">},{</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span> <span class="p">}</span> <span class="p">};</span>
<span class="kt">void</span> <span class="n">node</span><span class="o">::</span><span class="n">expand</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">index</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">newZP</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="n">m_Zero</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">trans</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">m_Zero</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">trans</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="p">};</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">newZP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">newZP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">3</span> <span class="o">||</span> <span class="n">newZP</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">newZP</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">3</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>

        <span class="c1">// 新的数码位置</span>
        <span class="kt">int</span> <span class="n">newState</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span>

        <span class="c1">// 初始化为当前状态</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">newState</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">m_State</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// 交换 m_Zero 与 newZP 两个位置的数</span>
        <span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="n">newState</span><span class="p">[</span><span class="n">m_Zero</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">m_Zero</span><span class="p">[</span><span class="mi">1</span><span class="p">]];</span>
        <span class="n">newState</span><span class="p">[</span><span class="n">m_Zero</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">m_Zero</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">newState</span><span class="p">[</span><span class="n">newZP</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">newZP</span><span class="p">[</span><span class="mi">1</span><span class="p">]];</span>
        <span class="n">newState</span><span class="p">[</span><span class="n">newZP</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">newZP</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">t</span><span class="p">;</span>

        <span class="c1">// 排除与父节点相同的节点</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">m_Parent</span> <span class="o">&amp;&amp;</span> <span class="o">*</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">m_Parent</span><span class="p">)</span> <span class="o">==</span> <span class="n">newState</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>

        <span class="n">node</span><span class="o">*</span> <span class="n">P</span> <span class="o">=</span> <span class="n">findP</span><span class="p">(</span><span class="n">newState</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">P</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// 新建节点并加入 OPEN</span>
            <span class="n">node</span> <span class="o">*</span><span class="n">newN</span> <span class="o">=</span> <span class="k">new</span> <span class="n">node</span><span class="p">(</span><span class="n">newState</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
            <span class="n">OPEN</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">newN</span><span class="p">);</span>
            <span class="n">m_Childern</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">newN</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="c1">// 已存在，若当前节点代价更小，更改已存在的节点指针及其子节点代价</span>
            <span class="n">node</span> <span class="o">*</span><span class="n">newN</span> <span class="o">=</span> <span class="k">new</span> <span class="n">node</span><span class="p">(</span><span class="n">newState</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">P</span><span class="o">-&gt;</span><span class="n">getPrice</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">newN</span><span class="o">-&gt;</span><span class="n">getPrice</span><span class="p">())</span> <span class="p">{</span>
                <span class="c1">// 修改 P 的父节点为当前节点</span>
                <span class="n">P</span><span class="o">-&gt;</span><span class="n">m_Parent</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
                <span class="n">P</span><span class="o">-&gt;</span><span class="n">calcG</span><span class="p">();</span>
                <span class="n">updateAll</span><span class="p">(</span><span class="n">P</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">delete</span> <span class="n">newN</span><span class="p">;</span>
                <span class="n">newN</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p>其中的 <code>updateAll()</code> 递归地更新了 P 的所有子节点的估价。</p>
<h3>OPEN 表与 CLOSE 表</h3>
<p>使用 <code>std::vector</code> 作为容器：</p>
<div class="highlight"><pre><span></span><span class="k">extern</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">node</span><span class="o">*&gt;</span> <span class="n">OPEN</span><span class="p">;</span>
<span class="k">extern</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">node</span><span class="o">*&gt;</span> <span class="n">CLOSE</span><span class="p">;</span>
</pre></div>
<h3>算法执行</h3>
<p>执行函数：</p>
<div class="highlight"><pre><span></span><span class="n">node</span><span class="o">*</span> <span class="nf">execute</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// OPEN 为空</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">OPEN</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// 获得估价最小的节点</span>
    <span class="n">node</span> <span class="o">*</span><span class="n">now</span> <span class="o">=</span> <span class="n">get</span><span class="p">();</span>

    <span class="c1">// 删除 OPEN 表中元素</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">node</span><span class="o">*&gt;::</span><span class="n">iterator</span> <span class="n">it</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">it</span> <span class="o">=</span> <span class="n">OPEN</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">it</span> <span class="o">!=</span> <span class="n">OPEN</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="n">it</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">it</span> <span class="o">==</span> <span class="n">now</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">OPEN</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">it</span><span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// 放入 CLOSE 表</span>
    <span class="n">CLOSE</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">now</span><span class="p">);</span>
    <span class="c1">// 若抵达目标</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">now</span> <span class="o">==</span> <span class="n">target</span><span class="p">)</span> <span class="k">return</span> <span class="n">now</span><span class="p">;</span>

    <span class="c1">// 扩展该节点</span>
    <span class="n">now</span><span class="o">-&gt;</span><span class="n">expand</span><span class="p">();</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;OPEN: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">OPEN</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">CLOSE: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">CLOSE</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>

    <span class="c1">// 递归调用</span>
    <span class="n">node</span><span class="o">*</span><span class="n">n</span> <span class="o">=</span> <span class="n">execute</span><span class="p">();</span> 

    <span class="c1">// 返回目标</span>
    <span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">return</span> <span class="n">n</span><span class="p">;</span>

    <span class="c1">// 查找失败</span>
    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">OPEN</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
    <span class="n">CLOSE</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
    <span class="n">node</span> <span class="o">*</span><span class="n">st</span> <span class="o">=</span> <span class="k">new</span> <span class="n">node</span><span class="p">(</span><span class="n">start</span><span class="p">);</span>
    <span class="n">OPEN</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">st</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">output</span><span class="p">(</span><span class="n">execute</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
<h2>测试结果</h2>
<table>
<thead><tr>
<th>G</th>
<th>H</th>
<th>OPEN 表大小</th>
<th>CLOSE 表大小</th>
</tr>
</thead>
<tbody>
<tr>
<td>41</td>
<td>0</td>
<td>172546</td>
<td>188600</td>
</tr>
</tbody>
</table>
<p>最终寻找到的路径步数为 41 步，已扩展节点数 188600 个，待扩展节点数 172546 个，也就是说算法搜索了接近 400000 个节点最终找到了一个路径。路径变换见附件 out.txt（从下到上为转变路径）。</p>
<h2>讨论与总结</h2>
<h3>有解性判断</h3>
<p>对 15 数码问题，并非任何两种状态之间都可以相互转换，当前节点 n 相对目标节点 S 的有解性可以用以下准则判断：(n 逆序数奇偶性==S 逆序数奇偶性)==(0到目标位置的行距%2==0)。其中逆序数为将节点排成一列，其中每个数码前方比自己大的数码个数之和。</p>
<p>有解性判断可用在初始节点的判断上，当判断其无解后就无需再进行搜索了。但是该性质不能帮助搜索过程中的剪枝，因为一旦初始节点有解，由初始节点扩展出的节点都有解。</p>
<h3>算法不足</h3>
<p>影响该算法性能的主要原因是 OPEN 表的排序这一步。实际实现过程中无需对 OPEN 表全局排序，只需要挑出其中估价最小的节点即可，但是这也需要遍历比较。在节点较多时，这是一个瓶颈。</p>
<p>另外估价函数的设计会使算法性能差别很大。当估价函数的启发性不足时，会生成大量的无用节点，延长搜索时间。</p>
<hr>
<p>附件：<a href="/resources/num15/main.cpp">main.cpp</a> | <a href="/resources/num15/node.h">node.h</a> | <a href="/resources/num15/node.cpp">node.cpp</a> | <a href="/resources/num15/out.txt">out.txt</a></p>
</div>
        
        <div class="prism-action-bar">
            <div class="comment-action action-item"><a class="no-link text-uppercase" href="/archives/216/#prism__comment" target="_self"><i class="fa fa-comment"></i>评论</a></div>
        </div>
        
    </article>
    
    <article class="yue prism-post-item col-md-8 offset-md-2">
        <h1 class="prism-post-title"><a class="no-link" href="/archives/213/" target="_self">使用 Travis CI 自动生成与部署 Hexo 博客</a></h1>
        <div class="prism-post-time">
            <a class="no-link" href="/archives/213/" target="_self">
                <time class="text-uppercase">
                    November 20 2018
                </time>
            </a>
        </div>
        <div class="prism-content"><p>我相信有许多同学选择使用 Hexo + GitHub Pages 作为自己的博客解决方案，例如我的 <a href="https://wiki.imalan.cn">Wiki 站点</a>即是如此。但是 Hexo 每次写完文章后都要执行一次生成与部署，当文章比较多时这个过程可能变得很慢。</p>
<p>本文介绍了使用 Travis CI 作为自动化手段实现构建、部署 Hexo 博客的过程。这种方法无需手动执行 <code>hexo g</code> 与 <code>hexo d</code> ，只需在每次编写文章后将更改 push 至远程仓库即可，顺带实现了博客源码备份。使用该方法在第一次配置完成后即使是无 NodeJS 与 Hexo 环境时也可以编写并发布文章，因为构建与部署本身是由 Travis CI 完成的。</p>
<h2>Travis CI</h2>
<p>CI 是 Continuous Integration 的缩写，即「持续集成」，本意是帮助开发者在开发过程中随时对小规模的的代码更改进行生成、测试、部署。<a href="https://travis-ci.com/">Travis CI</a> 提供基于 GitHub 的 CI 服务，它可以从 GitHub 上随时同步代码，并对其进行生成与部署。</p>
<p>或许有同学接触过 GitHub 的 Webhooks 功能，即当代码仓库发生某些操作时，GitHub 会向指定的地址发送请求，当服务端收到这些请求时即可进行下一步操作，例如拉取最新代码-生成-部署。Travis CI 所做的事情与之是类似的。</p>
<h2>思路</h2>
<p>基本的思路如图（诚意手绘）：</p>
<p><figure class="pswp-item" style="flex: 94.69820554649266" data-width="1161" data-height="613"><img src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/archives/assets/f6f24895b64448a63431fde2d0c27a09.jpg" alt="原理流程" /><figcaption>原理流程</figcaption></figure></p>
<p>例如我的代码仓库 <a href="https://github.com/AlanDecode/alandecode.github.io">alandecode.github.io</a> ，其 master 分支用于存储 Hexo 生成的静态文件，即博客网页；source 分支则用于存储博客源码，一般包括了 <code>_config.yml</code>、<code>source</code>、<code>themes</code>、<code>package.json</code> 、<code>scaffolds</code> 等文件与目录。</p>
<p>整个工作循环是这样的：在 source 分支下编写新的文章并保存，commit 后 push 至 GitHub 上的 source 分支。Travis CI 探测到 push 操作，即从 source 分支拉取新的源代码，并在自己的服务器上执行生成过程，并将生成结果 push 至代码仓库的 master 分支，完成部署过程。</p>
<h2>实现</h2>
<blockquote><p>假设你已经对 Hexo 的部署与发布有一定的了解，博客已经部署在 xxxx.github.io 这个仓库的 master 分支上。</p>
</blockquote>
<h3>GitHub 侧</h3>
<h4>仓库设置</h4>
<p>首先将博客仓库 clone 至本地：</p>
<div class="highlight"><pre><span></span>git clone git@github.com:xxxx/xxxx.github.io.git
</pre></div>
<p>然后进入代码仓库，创建并切换至新的分支 <code>source</code>：</p>
<div class="highlight"><pre><span></span><span class="nb">cd</span> xxxx.github.io
git checkout -b <span class="nb">source</span>
</pre></div>
<p>删除 xxxx.github.io 目录下的所有代码文件（注意不要删除 .git 目录），然后将你的 Hexo 博客源代码尽数拷贝至 xxxx.github.io 目录下。<strong>确保除 xxxx.github.io 根目录下存在 .git 文件夹外，其余位置均不存在</strong>，例如你的第三方主题可能是直接 clone 下来的，里面会有 .git 文件夹，删掉它。</p>
<p>某些临时文件是不必要推送到远端的，为了加快 push 速度，在 xxxx.github.io 下新建 .gitignore 文件，内容为：</p>
<div class="highlight"><pre><span></span>.DS_Store
Thumbs.db
db.json
*.log
node_modules/
public/
.deploy*/
</pre></div>
<p>检查一下此时 xxxx.github.io 目录下应该包括了 package.json 文件，里面记录了所有的依赖包。此时执行一次 commit 与 push：</p>
<div class="highlight"><pre><span></span>git add .
git commit -m <span class="s1">&#39;init source&#39;</span>
git push --set-upstream origin <span class="nb">source</span>
</pre></div>
<p>此时 source 分支应该已经推送至 GitHub 了。由于以后我们只会修改 source 分支，为了方便将 source 分支设置为默认分支：GitHub 仓库 Settings → Branches → Default Branch 设置为 source。</p>
<h4>获取 Access Token</h4>
<p>点击 GitHub 右上角头像 → Settings → Developer settings → Personal access tokens，点击 Generate new token，设置 token 名称，并勾选 repo 前面的框。</p>
<p><figure class="pswp-item" style="flex: 116.05504587155963" data-width="1265" data-height="545"><img src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/archives/assets/14ad1d8e0f4de8e8efd7f9acbb838ffd.png" alt="access-token.png" /><figcaption>access-token.png</figcaption></figure></p>
<p>点击 Generate，然后将新生成的 token 记下。保管好它，你以后不会再看到这个 token 第二次了。</p>
<h3>Travis CI 侧</h3>
<p>去 <a href="https://www.travis-ci.org/">Travis CI 官网</a>，使用 GitHub 账号登录，然后添加仓库：待仓库列表同步完成后将 xxxx.github.io 勾选。</p>
<p><figure class="pswp-item" style="flex: 108.29268292682927" data-width="1332" data-height="615"><img src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/archives/assets/3a96d1a0961d8412b8335a4d74f81555.png" alt="add-repo.png" /><figcaption>add-repo.png</figcaption></figure></p>
<p>然后点击旁边的 Settings 按钮，如图设置：</p>
<p><figure class="pswp-item" style="flex: 97.5" data-width="1521" data-height="780"><img src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/archives/assets/a4dfd8b8dec5a44e1ee53e1bd186c24f.png" alt="travis-settings.png" /><figcaption>travis-settings.png</figcaption></figure></p>
<p>下方 Environment Variables 填写 name 为 travis，然后 Value 为 GitHub 获得的 Access Token，取消勾选 Display value in build log，点击 add。</p>
<h3>添加 travis 配置文件</h3>
<p>回到 xxxx.github.io 目录下，创建一个 .travis.yml 的文件，内容为：</p>
<div class="highlight"><pre><span></span><span class="nt">language</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">node_js</span>
<span class="nt">node_js</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">stable</span>
<span class="nt">install</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">npm install</span>
<span class="nt">script</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">hexo g</span>
<span class="nt">after_script</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cd ./public</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">git init</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">git config user.name &quot;【GitHub 用户名】&quot;</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">git config user.email &quot;【GitHub 邮箱】&quot;</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">git add .</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">git commit -m &quot;Update docs&quot;</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">git push --force --quiet &quot;https://${travis}@${GH_REF}&quot; master:master</span>
<span class="nt">branches</span><span class="p">:</span>
  <span class="nt">only</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">source</span>
<span class="nt">env</span><span class="p">:</span>
  <span class="nt">global</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">GH_REF</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">【github.com/AlanDecode/alandecode.github.io.git】</span>
</pre></div>
<p>对应修改其中用【】括起来的部分。再执行一次 commit 与 push：</p>
<div class="highlight"><pre><span></span>git add .
git commit -m <span class="s1">&#39;update&#39;</span>
git push
</pre></div>
<p>稍等片刻，在 Travis CI 的控制面板将可以看到构建历史：</p>
<p><figure class="pswp-item" style="flex: 111.51586368977674" data-width="1898" data-height="851"><img src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/archives/assets/e5f8b4dd4437c10ce99433772ed1694f.png" alt="build-history.png" /><figcaption>build-history.png</figcaption></figure></p>
<p>若状态为 passed 则说明部署成功。</p>
<h2>总结</h2>
<p>如此下来，Hexo 生成、部署繁琐的问题也没有了。不过即使它万般好，评论系统仍然令人头疼。</p>
<p>以上。</p>
</div>
        
        <div class="prism-action-bar">
            <div class="comment-action action-item"><a class="no-link text-uppercase" href="/archives/213/#prism__comment" target="_self"><i class="fa fa-comment"></i>评论</a></div>
        </div>
        
    </article>
    
    <article class="yue prism-post-item col-md-8 offset-md-2">
        <h1 class="prism-post-title"><a class="no-link" href="/archives/197/" target="_self">音乐 - 游戏的点睛之笔</a></h1>
        <div class="prism-post-time">
            <a class="no-link" href="/archives/197/" target="_self">
                <time class="text-uppercase">
                    November 16 2018
                </time>
            </a>
        </div>
        <div class="prism-content"><blockquote><p>熊猫注：这篇文章是我的好朋友 Ben 的作品，上次我写了一篇聊日漫配乐的文章，没想到激发了他的创作欲，当即表示要写一篇游戏配乐的文章。没想到一个月了，我都以为他要鸽了，结果他今天给了我一个惊喜，稿子来了！我赶紧给排好版发出来，来跟我一起拜读之~</p>
</blockquote>
<p>一个月前看了熊猫的博客，文中列举了他心目中能拨动心弦的动漫配乐。自己也是越看越来劲，仿佛把童年以来的美好回忆再品味了一遍，文章读罢自己也饶有兴致，想着也来列举一些游戏相关的配乐，当即夸下海口，想让熊猫帮忙推推，殊不知懒癌一犯就是一月，再不完成恐会被其狠狠调侃，故特此呈上。</p>
<p>说到游戏中的配乐，不管是有没有玩过游戏的人都会听过几段，《超级马里奥》、《CS》、《坦克大战》等等，这些重复了一遍又一遍的配乐已经深深的印入了人们的脑海里。但是今天所要讨论的，不一定就是那些让人耳熟能详的游戏配乐，相反甚至大多数人都未曾听过，但无论怎样，接下来所推荐的配乐，都是我十几年游戏经历里，让游戏体验性直接升华的点睛之笔。</p>
<blockquote><p>以下列举无排名先后，仅按照小编游玩顺序。</p>
</blockquote>
<h2>《最终幻想7：核心危机》 OST By 石元丈晴</h2>
<div class="photos">
<figure class="pswp-item" style="flex: 88.79551820728291" data-width="1268" data-height="714"><img src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/archives/assets/c9cd488567518b32557b5034e2676d41.jpg" alt="最终幻想7.jpg" /><figcaption>最终幻想7.jpg</figcaption></figure></div><p>SE 大厂的看家 IP，游戏本身名气不用说，其中又以《最终幻想7》为最受欢迎的系列作品（不接受辩驳），但是此系列在国内的受众还是相对较低，属于听说过没玩过的那一类游戏。而《核心危机》作为 7 代的外传反而在中国大陆上有相当高的普及度（受益于 PSP 的引进和破解）。《核心危机》拥有着比 7 代本体好 N 倍的画面，同时还保留了本体所有的优点：剧情，人设，游戏性，当然还有最重要的配乐。</p>
<p>本作的 OST 我是每一首都推荐的，但是如果读者没有玩过此款游戏的话，从头到尾听下来会显得很枯燥，不知道这帮搞交响乐的人想表达什么意思，因此我从里摘出几首理解起来较为轻松的配乐，分别是：</p>
<div class="Meting">
[Music server="netease" id="2515090183" type="playlist"/]</div><p>作为通关此游戏三次的玩家，我在此强烈推荐有条件的玩家一定要入手一个 PSP，自己亲手去体验一把这款游戏，剧情和配乐的结合所产生的 “1+1＞2” 的效果可不是盖的，另外，感性之人游玩的话请备好纸巾（纸巾是用在上面那个头的！），我反正是玩一次哭一次完全抵抗不住滴。</p>
<div class="photos">
<figure class="pswp-item" style="flex: 66.66666666666667" data-width="1024" data-height="768"><img src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/archives/assets/8c47bf69b9a3281f273cf89e19b11a12.jpg" alt="最终幻想7_1.jpg" /><figcaption>最终幻想7_1.jpg</figcaption></figure></div><h2>《刺客信条2》 OST By Jesper Kyd</h2>
<p>AC 系列尽管如今依然坚挺，但是最让人回味无穷的我还是投第 2 代，不是说 2 代三部曲，就是单纯的指第二代，Ezio 从纨绔子弟到刺客大师的一代。</p>
<p>此作所取得的成就在游戏界人尽皆知，跌宕的剧情，令人迷醉的意大利景观，当地当时民风的完美还原，再配上 Jesper 精湛的作曲手艺，共同造就了这款荡气回肠的《刺客信条 2》。</p>
<div class="photos">
<figure class="pswp-item" style="flex: 88.79551820728291" data-width="1268" data-height="714"><img src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/archives/assets/8598c3526a76231b83976ba11ead3b98.jpg" alt="刺客信条2.jpg" /><figcaption>刺客信条2.jpg</figcaption></figure></div><p>不同于《核心危机》，《刺客信条 2》的 OST 带给人的是空灵的感觉，在游戏中，你会随着 Ezio 一起成长，复仇并带着自己的族人们复兴，期间激情的战斗配乐不用赘述，但是当游戏剧情推动到一定地步的时候（具体什么地步实在不忍心剧透），当那首《Ezio’s Family》响起的时候，当美声和小提琴结合的时候，你定会沉醉于文艺复兴时期的意大利。OST 中的歌曲推荐（网易云音乐没有版权……）：</p>
<ul>
<li>《Ezio’s Family》</li>
<li>《Earth》</li>
<li>《Venice Rooftops》</li>
</ul>
<h2>《使命召唤6》OST By Hans Zimmer ＆ Lorne Balfe</h2>
<div class="photos">
<figure class="pswp-item" style="flex: 80.0" data-width="1920" data-height="1200"><img src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/archives/assets/f9c35aa6ee9b8c2e861e8c10ebba0d07.jpg" alt="使命召唤6.jpg" /><figcaption>使命召唤6.jpg</figcaption></figure></div><p>光看这名作曲人，我想此 OST 的质量已无需多言。</p>
<p>《使命召唤 6》系列是其现代战争三部曲中的第二代，也是我心目中 15 部使命召唤系列中的最强神作，在《使命召唤》主打剧情的那个年代，6 代无疑是最成功的集大成者，游戏本身的精彩程度可参考电影界的《黑鹰坠落》，甚至比《黑鹰》更扣人心弦：火爆的枪战，有血有肉的人物塑造，完美的剧情节奏，战争阴谋论，反战主义，以及那<strong>无与伦比，惊为天人</strong>的背景配乐。</p>
<p>是的，这两个形容词只能稍稍形容一下这作的 OST 在我心中的地位，如果你挨个听过后你就会发现：哦~原来以前某某电视节目用过。</p>
<p>那么，OST 中我推荐哪些配乐呢？答案是全部，没错就是全部，所有的歌都值得听一遍（我就是这么舔使命 6！！！）</p>
<p>但是为了杜绝被吐槽懒的可能，还是放上几首尤其优秀的配乐：</p>
<div class="Meting">
[Music server="netease" id="2515433769" type="playlist"/]</div><h2>《最后生还者》OST By Gustavo Santaolalla</h2>
<div class="photos">
<figure class="pswp-item" style="flex: 88.79551820728291" data-width="1268" data-height="714"><img src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/archives/assets/2db3cc0cde04c638fa77acdad125557c.jpg" alt="最后生还者.jpg" /><figcaption>最后生还者.jpg</figcaption></figure></div><p>这位作曲人同样是世界级的，但是没有 Zimmer 那么出名，不过他作为《断背山》和《巴别塔》的编曲人，已经足够奠定他世界一流作曲人的地位了。</p>
<p>G 叔的作曲向来有着很明显的南美风情，但是在表达感情时又意外的有着东方人的含蓄内敛，这正是造成他曲风暗含忧伤的直接原因。而这样的曲风极其适合《最后生还者》这样的末日游戏。作为一款只要是个正规媒体就评满分，只要是个颁奖典礼都会给其颁奖的游戏，其本身的素质已经无须赘述，而倘若你仔细研读每个媒体给出的满分评价，你会发现总会有单独的一段盛赞这款游戏的配乐。</p>
<p>如果大家没有 PS3 或 PS4 却又向往这样一款神作的话，可以去B站观看纯黑做的系列视频（完全当美剧看），免费体验一下这款神作。说到 OST 中推荐的音乐：</p>
<div class="Meting">
[Music server="netease" id="2515109233" type="playlist"/]</div><h2>《巫师3》 By Marcin Przybyłowicz ＆ Emma Hiddleston</h2>
<div class="photos">
<figure class="pswp-item" style="flex: 119.33174224343675" data-width="1000" data-height="419"><img src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/archives/assets/fc2ce6872f028ef689a2cc9c44e22c66.jpg" alt="巫师3.jpg" /><figcaption>巫师3.jpg</figcaption></figure></div><p>作为 2016 年的“Game of the Year”，当年《巫师 3》的上市可谓是技惊四座，强如《辐射 4》也只能沦为配角。我也是早早的就预购的这款游戏，但当时仅是被其强大的画质和剧情所吸引，却没想到游玩之后最让我流连忘返的，除了“众多”女主角的身材以外，就是能展现壮阔猎魔人世界的配乐了。</p>
<p>《巫师 3》的系列配乐有很多，不仅仅是 OST 的那部分，<ruby>波兰蠢驴<rp>(</rp><rt>liang xin chang jia</rt><rp>)</rp></ruby>还砸一大笔钱在营销上，尤其是各种原生配乐的创作上，这些配乐在结合游戏本身的场景设计和剧情推进的时候，或让人起鸡皮疙瘩，或让人潸然泪下，或耐人寻味。所以还是那句话，请登录 STEAM 喜加一，小花几十块钱购买一下这款最便宜的 3A 大作，充分体验一下这场视听盛宴（请注意不要在游戏中沉迷打牌）。</p>
<p>在综合比对了 OST 部分和原生配乐后，我筛选出以下几首供大伙欣赏：</p>
<div class="Meting">
[Music server="netease" id="2515069638" type="playlist"/]</div><p>巫师 3 的史诗级音乐实在太多，无法一一列出，感兴趣的朋友可以去网易云音乐下载它的 OST 音乐包。</p>
<div class="photos">
<figure class="pswp-item" style="flex: 88.92857142857143" data-width="996" data-height="560"><img src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/archives/assets/432282e98de679b3c90b3b67b1d9a535.jpg" alt="巫师3_1.jpg" /><figcaption>巫师3_1.jpg</figcaption></figure></div><h2>《返校 detention》 By 張衞帆</h2>
<p>不可多得的国产佳作。</p>
<p>由于自己对武侠类游戏实在提不起兴趣，所以玩过的经典国产游戏并不多，而玩过的国产游戏中能让我觉得品质优秀的就更寥寥无几。但是今年体验的这款《返校》可是着着实实的惊艳到我了。</p>
<p>故事背景是台湾的白色恐怖时期，可以类比于加长版的“那十年”，剧情大致可概括为政治高压与家庭暴力造成的悲剧。</p>
<p>游戏表现手法多为象征，需要玩家认真思考理解；且融合了很多中国的鬼神元素（能给亚洲人带来熟悉的恐怖），剧情叙述方式为错叙，游玩过程中会让人摸不着头脑，但是最后随着剧情碎片逐渐拼起来，整体故事也就一目了然。</p>
<p>游戏的定位是恐怖游戏，所以过程中的配乐以压抑，怪诞的氛围为主，但是当游戏快结束时，主角的记忆和真实情感被逐渐找回时，配乐和主角一样在一瞬间释怀了。相信最后真相大白，BGM 响起时，每个玩家都会呆滞在屏幕前。音乐推荐：</p>
<div class="Meting">
[Music server="netease" id="2515076821" type="playlist"/]</div><p>游戏配乐与游戏本身是相辅相成，互相升华的关系，谁也离不开谁。如果读者在听了上面提到的某些歌曲完全无感甚至觉得不知所云的话，也是正常的，毕竟缺失了游戏本体这一环，就像没看过《未闻花名》就觉得《Secret Base》一般般一样。所以我也是建议各位读者有时间有条件一定要体验一下上述的几款游戏，毕竟音乐只是游戏的画龙点睛之笔，离了游戏，光看一点艳丽的颜色在白纸上也是索然无味的。</p>
</div>
        
        <div class="prism-action-bar">
            <div class="comment-action action-item"><a class="no-link text-uppercase" href="/archives/197/#prism__comment" target="_self"><i class="fa fa-comment"></i>评论</a></div>
        </div>
        
    </article>
    
    <article class="yue prism-post-item col-md-8 offset-md-2">
        <h1 class="prism-post-title"><a class="no-link" href="/archives/206/" target="_self">生活总有小乱子</a></h1>
        <div class="prism-post-time">
            <a class="no-link" href="/archives/206/" target="_self">
                <time class="text-uppercase">
                    November 15 2018
                </time>
            </a>
        </div>
        <div class="prism-content"><p>又到了写日常的时间。近来主要的精力放在工作上，累得要命；剩下一点可怜的精力则用来修复主题无穷无尽的 bug，基本没有多余的时间来看书或者看番。待这一阵熬过去我势必要放纵一番。</p>
<hr>
<p>一直没来得及在博客上提及苹果十月发布的新品，这次发布会比 9 月场好看得多（<del>貌似也贵得多</del>）。Mac 系列一直以来都是我很憧憬的设备。大一短暂地使用过最低配 11-inch MacBook Air，当时年轻，面对 OS X（当时还叫这名）不为所动，反倒是在 128G 的 SSD 上硬生生又塞进去一个 Windows 7，现在想来简直是暴殄天物。当我了解到 OS X 的强大时，设备已经被我卖掉了。经过了后来几年追逐最新设备，我逐渐从买新设备中毕业了。算起来这还是苹果自己教给我的道理。</p>
<p>我很喜欢苹果的广告，经常去 Apple YouTube 官方频道一遍又一遍地看，久而久之我逐渐开始思考为什么这样的广告吸引我，而 OPPO、ViVO 却做不到。仔细看 Apple 的广告，其重点几乎从来不是“我们的产品多厉害”，而是“你用我们的产品能完成什么事情”，that is:</p>
<blockquote><p>Don't focus on the device itself, focus on things you can do with it instead.</p>
</blockquote>
<p>这就是我对消费级电子产品的态度：更关心这个设备能对我的日常工作生活有何辅助，而不是它有多大的内存，多少个核心。</p>
<p>当明白这一点时，我对新设备的渴望就消减了。当我的 iPhone 进水损坏时，我选择花 2000 去直营店换新机继续使用，而不是花 6000 买一部 iPhone 8，因为我明白，iPhone 8 能帮我做到的，iPhone 7 也可以。这与那种「又不是不能用」的得过且过不同，更偏向理性的考虑。</p>
<p>我对 iPad 的态度转变也是源于此。前段时间卖掉了手里的 iPad，换成了价格更低的 Windows 便携笔记本，发现这是非常适合我的选项。用这个廉价笔记本，我完成了很多 iPad 很难做到的事情（比如写出了 RAW 这个主题）。一个真正合用的键盘，全功能的 Windows 10 系统，<strong>对我来说</strong>就是生产力。</p>
<hr>
<p>生产力就是创造，但近两个月，世界上两位极有创造力的人却离开了：一位是金庸，一位是 Stan Lee。说实话，我不是武侠迷，漫威电影虽（几乎）悉数看了，对美漫却了解甚少。但这二位的离去仍然让我唏嘘不已。</p>
<p>得知 Stan Lee 去世的那个早上前一天我刚在电影院看《毒液》，最后老爷子遛狗的镜头还引我发笑。我看漫威电影不只一次地想过，老爷子一大把年纪了，希望身体硬朗啊，没想到……</p>
<p>金庸与 Stan Lee，一位为东方阐释英雄主义，一位为西方阐释英雄主义。许许多多的人，就是在他们作品的熏陶下，得到了正义、爱与希望的启蒙。多希望他们能继续下去，可是时间却没法倒流了。</p>
<hr>
<p>我想起前两天发生的一件小事。当时是晚饭后去校门口咖啡店买咖啡，看到一男一女打架，我赶紧上去拉开。男的让我直接报警，女的不依不饶。</p>
<p>我说，报警不至于，处理好就行。女的用响彻云霄的声音对我吼：“关你什么事！你能不能滚开！？”</p>
<p>我顿时愣住，回头看一眼围观群众，觉得极其尴尬，然后就离开了，事后我觉得我怂。但过了一夜再回头想，真的便觉得关我什么事呢？大家都有自己的生活，以及生活中无法避免的小乱子。</p>
<p>我曾憧憬一个互相不打扰的简单社会，但是这样人与人之间大概真的会变得冷漠吧。「尊重别人的意志」变成了幌子，用来掩盖自己薄弱的社交能力。有一件事情我说不好：我们到底是应该期待一个人人都据理力争却冲突不断的社会，还是一个管好自己却互相不再接触的社会呢？</p>
<p>但唯一确定的是，生活总有小乱子。只盼自己能驶好生活这艘小船，虽可能摇摇晃晃，但只要能平安抵达目的地，就算是一辈子过得凑合了。</p>
</div>
        
        <div class="prism-action-bar">
            <div class="comment-action action-item"><a class="no-link text-uppercase" href="/archives/206/#prism__comment" target="_self"><i class="fa fa-comment"></i>评论</a></div>
        </div>
        
    </article>
    
    <article class="yue prism-post-item col-md-8 offset-md-2">
        <h1 class="prism-post-title"><a class="no-link" href="/archives/194/" target="_self">常用页面元素示例</a></h1>
        <div class="prism-post-time">
            <a class="no-link" href="/archives/194/" target="_self">
                <time class="text-uppercase">
                    November 09 2018
                </time>
            </a>
        </div>
        <div class="prism-content"><h2>二级标题</h2>
<h3>三级标题</h3>
<h4>四级标题</h4>
<h5>五级标题</h5>
<h6>六级标题</h6>
<h2>普通文字</h2>
<p>予观夫巴陵胜状，在洞庭一湖。衔远山，吞长江，浩浩汤汤，横无际涯；朝晖夕阴，气象万千。此则岳阳楼之大观也，前人之述备矣。然则北通巫峡，南极潇湘，迁客骚人，多会于此，览物之情，得无异乎？若夫霪雨霏霏，连月不开，阴风怒号，浊浪排空；日星隐曜，山岳潜形；商旅不行，樯倾楫摧；薄暮冥冥，虎啸猿啼。登斯楼也，则有去国怀乡，忧谗畏讥，满目萧然，感极而悲者矣。至若春和景明，波澜不惊，上下天光，一碧万顷；沙鸥翔集，锦鳞游泳；岸芷汀兰，郁郁青青。而或长烟一空，皓月千里，浮光跃金，静影沉璧，渔歌互答，此乐何极！登斯楼也，则有心旷神怡，宠辱偕忘，把酒临风，其喜洋洋者矣。</p>
<h2>常用行内元素</h2>
<p>这是<strong>加粗</strong>，<em>斜体</em>，<del>删除线</del>，<a href="https://blog.imalan.cn">链接</a><sup id="fn_ref_1"><a href="#fn_1">1</a></sup>。</p>
<h2>块引用与嵌套块引用</h2>
<blockquote><p>安得广厦千万间，大庇天下寒士俱欢颜！风雨不动安如山。</p>
<blockquote><p>呜呼！何时眼前突兀见此屋，吾庐独破受冻死亦足！</p>
</blockquote>
</blockquote>
<h2>代码与高亮</h2>
<p>这是行内代码：<code>int a=1;</code>。这是代码块：</p>
<div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span> <span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">){</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Hello World!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<h2>列表</h2>
<h3>无序列表</h3>
<ul>
<li>苹果<ul>
<li>红将军</li>
<li>元帅</li>
</ul>
</li>
<li>香蕉</li>
<li>梨</li>
</ul>
<h3>有序列表</h3>
<ol>
<li>打开冰箱<ol>
<li>右手放在冰箱门拉手上</li>
<li>左手扶住冰箱主体</li>
<li>右手向后用力</li>
</ol>
</li>
<li>把大象放进冰箱</li>
<li>关上冰箱</li>
</ol>
<h2>分割线</h2>
<hr>
<h2>数学公式</h2>
<p>这是行内公式：$m\times n$，这是块级公式：</p>
<p>$$C_{m\times k}=A_{m\times n}\cdot B_{n\times k}$$</p>
<h2>图片与排版</h2>
<h3>单张图片</h3>
<p><figure class="pswp-item" style="flex: 92.88888888888889" data-width="836" data-height="450"><img src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/archives/assets/85faf2766d0b770daed751dfcfde4c72.jpg" alt="幽灵公主剧照" /><figcaption>幽灵公主剧照</figcaption></figure></p>
<h3>图片排版</h3>
<div class="photos">
<figure class="pswp-item" style="flex: 75.0" data-width="4032" data-height="2688"><img src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/archives/assets/b5b8f3a962acc2447a3ca9daec920584.jpeg" alt="大运村鸟瞰" /><figcaption>大运村鸟瞰</figcaption></figure>
<figure class="pswp-item" style="flex: 50.03720238095238" data-width="2690" data-height="2688"><img src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/archives/assets/0ed318891b203c40182179e963c8d3e4.jpg" alt="" /></figure>
<figure class="pswp-item" style="flex: 75.0" data-width="4032" data-height="2688"><img src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/archives/assets/2d2f3851a0fe67571a88489cda343fe4.jpeg" alt="北航运动场" /><figcaption>北航运动场</figcaption></figure></div><div class="photos">
<figure class="pswp-item" style="flex: 75.0" data-width="4032" data-height="2688"><img src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/archives/assets/c2e1848b602e8288ede60b99c3a429de.jpeg" alt="" /></figure>
<figure class="pswp-item" style="flex: 75.0" data-width="4032" data-height="2688"><img src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/archives/assets/9d1701e52f4a0e52eb2caf54df463bdd.jpeg" alt="" /></figure>
<figure class="pswp-item" style="flex: 75.0" data-width="4032" data-height="2688"><img src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/archives/assets/d5ed11440357b06f0f093961d3401150.jpeg" alt="" /></figure></div><h2>表格</h2>
<table>
<thead><tr>
<th>第一格表头</th>
<th>第二格表头</th>
</tr>
</thead>
<tbody>
<tr>
<td>内容单元格 第一列第一格</td>
<td>内容单元格第二列第一格</td>
</tr>
<tr>
<td>内容单元格 第一列第二格 多加文字</td>
<td>内容单元格第二列第二格</td>
</tr>
</tbody>
</table>
<h2>友链样式</h2>
<div class="links">
<a style="display:block" target="_blank" href="https://www.imalan.cn" class="board-item">                 <div class="board-thumb"><img src="https://secure.gravatar.com/avatar/1741a6eef5c824899e347e4afcbaa75d?s=200&r=G&d="></div>                 <div class="board-title">熊猫小A</div></a>
<a style="display:block" target="_blank" href="https://blog.imalan.cn" class="board-item">                 <div class="board-thumb"><img src="https://secure.gravatar.com/avatar/1741a6eef5c824899e347e4afcbaa75d?s=200&r=G&d="></div>                 <div class="board-title">熊猫小A的博客</div></a></div><hr><div class="footnotes"><ol><li id="fn_1">这是脚注 <a no-style href="#fn_ref_1">↩</a></li></ol></div></div>
        
        <div class="prism-action-bar">
            <div class="comment-action action-item"><a class="no-link text-uppercase" href="/archives/194/#prism__comment" target="_self"><i class="fa fa-comment"></i>评论</a></div>
        </div>
        
    </article>
    
    <article class="yue prism-post-item col-md-8 offset-md-2">
        <h1 class="prism-post-title"><a class="no-link" href="/archives/189/" target="_self">Typecho 自定义文章编辑界面</a></h1>
        <div class="prism-post-time">
            <a class="no-link" href="/archives/189/" target="_self">
                <time class="text-uppercase">
                    November 04 2018
                </time>
            </a>
        </div>
        <div class="prism-content"><p>主题举步维艰地更新到了 0.4 版，相对之前版本有了巨多改善（其实是因为之前太渣了 ） 。</p>
<p>特别感到自豪的有两个，一个是修改了表情插入的方式，而且文章编辑界面也可以插入表情。另一个是方便的插入图集的方法（不用再写 HTML 了），也是通过后台的按钮实现的。说起来，自定义后台编辑界面是相当重要的技巧，因为某些稍高级的功能是通过短代码或者插入 HTML 实现的，而普通用户并不愿意这么做（废话，那还要 Markdown 干什么？）。这里记录一下其中的一种实现方式。</p>
<p>首先在模板根目录下的 functions.php 中添加</p>
<div class="highlight"><pre><span></span><span class="x">Typecho_Plugin::factory(&#39;admin/write-post.php&#39;)-&gt;bottom = array(&#39;Utils&#39;, &#39;addButton&#39;);</span>
<span class="x">Typecho_Plugin::factory(&#39;admin/write-page.php&#39;)-&gt;bottom = array(&#39;Utils&#39;, &#39;addButton&#39;);</span>
</pre></div>
<p>这两行注册了两个方法，也就是在渲染 write-post.php 和 write-page.php 两个文件时要执行的方法。我们需要给出 addButton 方法的实现，同样在 functions.php 中：</p>
<div class="highlight"><pre><span></span><span class="x">class Utils {</span>
<span class="x">    public static function addButton(){</span>
<span class="x">         echo &#39;&lt;script type=&quot;text/javascript&quot; src=&quot;/usr/themes/RAW/assets/editor.js&quot;&gt;&lt;/script&gt;&#39;;</span>
<span class="x">    }</span>
<span class="x">}</span>
</pre></div>
<p>调用该方法后会在底部引入 editor.js 文件，在这个文件中，你就可以为所欲为了！这里提一个示例：添加一个 OwO 表情面板。</p>
<p>OwO 表情面板需要引入额外的 CSS 和 JS，因此在 addButton 方法中应该至少包括：</p>
<div class="highlight"><pre><span></span><span class="x">class Utils {</span>
<span class="x">    public static function addButton(){</span>
<span class="x">        echo &#39;&lt;script src=&quot;/usr/themes/RAW/assets/owo/owo.min.js&quot;&gt;&lt;/script&gt;&#39;;</span>
<span class="x">        echo &#39;&lt;script type=&quot;text/javascript&quot; src=&quot;/usr/themes/RAW/assets/editor.js&quot;&gt;&lt;/script&gt;&#39;;</span>
<span class="x">        echo &#39;&lt;link rel=&quot;stylesheet&quot; href=&quot;/usr/themes/RAW/assets/owo/owo.min.css&quot; /&gt;&#39;;</span>
<span class="x">    }</span>
<span class="x">}</span>
</pre></div>
<p>然后编辑 editor.js</p>
<div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#wmd-button-row&#39;</span><span class="p">).</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#wmd-button-row&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;&lt;li class=&quot;wmd-spacer wmd-spacer1&quot;&gt;&lt;/li&gt;&lt;li class=&quot;wmd-button&quot; id=&quot;wmd-owo-button&quot; style=&quot;&quot; title=&quot;插入表情&quot;&gt;&lt;span class=&quot;OwO&quot;&gt;&lt;/span&gt;&lt;/li&gt;&#39;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">owo</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OwO</span><span class="p">({</span>
        <span class="nx">logo</span><span class="o">:</span> <span class="s1">&#39;OωO&#39;</span><span class="p">,</span>
        <span class="nx">container</span><span class="o">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">&#39;OwO&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
        <span class="nx">target</span><span class="o">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">),</span>
        <span class="nx">api</span><span class="o">:</span> <span class="s1">&#39;/usr/themes/RAW/assets/owo/OwO.json&#39;</span><span class="p">,</span>
        <span class="nx">position</span><span class="o">:</span> <span class="s1">&#39;down&#39;</span><span class="p">,</span>
        <span class="nx">width</span><span class="o">:</span> <span class="s1">&#39;400px&#39;</span><span class="p">,</span>
        <span class="nx">maxHeight</span><span class="o">:</span> <span class="s1">&#39;250px&#39;</span>
        <span class="p">});</span>
    <span class="p">}</span>
</pre></div>
<p>这段 JS 在工具栏添加了一个 <code>&lt;span&gt;</code> 容器，并 new 了一个 OwO 对象，此时这个表情面板应该已经可以使用了！</p>
<p>要注意的是后台的样式可能与 Owo 有冲突，因此你可能需要校正一下样式。校正的方式是在 addButton 方法输出内容，使用 <code>&lt;style&gt;</code> 标签输出 CSS。</p>
</div>
        
        <div class="prism-action-bar">
            <div class="comment-action action-item"><a class="no-link text-uppercase" href="/archives/189/#prism__comment" target="_self"><i class="fa fa-comment"></i>评论</a></div>
        </div>
        
    </article>
    
    <article class="yue prism-post-item col-md-8 offset-md-2">
        <h1 class="prism-post-title"><a class="no-link" href="/archives/171/" target="_self">让炮姐跟着我跑 - 缓动跟随 Demo</a></h1>
        <div class="prism-post-time">
            <a class="no-link" href="/archives/171/" target="_self">
                <time class="text-uppercase">
                    October 22 2018
                </time>
            </a>
        </div>
        <div class="prism-content"><p>我们时常会遇到这样的需求：让物体平滑地移动至某处。一般来说，匀速地移动总是显得过于死板，不够 fancy，因此有变速移动的需求，即「缓动」。</p>
<p>这个问题的本质可以转化到对运动规律的设计上。我们都知道几种基本运动规律：匀速运动、匀加速运动、变加速运动的运动性质，要做的只是实现它们罢了。不过物理课上对它们的研究主要还是停留在连续域上，计算机世界是离散的，因此我们需要对这些运动规律做一个离散域的“移植”。</p>
<p>昨天我闲来无事，做了一个小的缓动跟随 Demo 如下。你可以试着以不同速度用鼠标拖动我的头像，观察炮姐头像的运动规律（手机上可能不好使）。</p>
<p><p data-height="467" data-theme-id="0" data-slug-hash="xyJXXm" data-default-tab="js,result" data-user="AlanDecode" data-pen-title="FollowMe" class="codepen">See the Pen <a href="https://codepen.io/AlanDecode/pen/xyJXXm/">FollowMe</a> by AlanDecode (<a href="https://codepen.io/AlanDecode">@AlanDecode</a>) on <a href="https://codepen.io">CodePen</a>.</p></p>
<script async src="https://static.codepen.io/assets/embed/ei.js"></script><p>当我的移动速度比较慢时，炮姐会以相对平均的速度慢慢追上我；当我的速度突然变快，我和炮姐之间的距离会被拉开，炮姐就会加快步伐追我，最后慢慢地停在我的边上。</p>
<p>这种运动规律与“离开多少追上多少”那种规律不同，在那种规律下，两次界面重绘之间我和炮姐拉开了多少距离，在重绘时就会立马被补上，是不是显得没什么人情味？</p>
<p>观察上面那个 Demo 中的 JS，核心代码是：</p>
<div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">followMe</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">me</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#me&quot;</span><span class="p">).</span><span class="nx">offset</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">paojie</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#paojie&quot;</span><span class="p">).</span><span class="nx">offset</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">distance</span><span class="p">(</span><span class="nx">me</span><span class="p">,</span><span class="nx">paojie</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">100</span><span class="p">){</span>
        <span class="kd">var</span> <span class="nx">moveX</span><span class="o">=</span><span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">left</span><span class="o">-</span><span class="nx">paojie</span><span class="p">.</span><span class="nx">left</span><span class="p">)</span><span class="o">*</span><span class="mf">0.002</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">moveY</span><span class="o">=</span><span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">top</span><span class="o">-</span><span class="nx">paojie</span><span class="p">.</span><span class="nx">top</span><span class="p">)</span><span class="o">*</span><span class="mf">0.002</span><span class="p">;</span>
        <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#paojie&quot;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">,</span><span class="nx">paojie</span><span class="p">.</span><span class="nx">left</span><span class="o">+</span><span class="nx">moveX</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">);</span>
        <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#paojie&quot;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">,</span><span class="nx">paojie</span><span class="p">.</span><span class="nx">top</span><span class="o">+</span><span class="nx">moveY</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">);</span> 
        <span class="nx">requestAnimationFrame</span><span class="p">(</span><span class="nx">followMe</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p>其中 <code>distance()</code> 函数用于计算我和炮姐之间的曼哈顿距离：</p>
<div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">distance</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="nx">y</span><span class="p">){</span>
    <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">left</span><span class="o">-</span><span class="nx">y</span><span class="p">.</span><span class="nx">left</span><span class="p">)</span><span class="o">+</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">top</span><span class="o">-</span><span class="nx">y</span><span class="p">.</span><span class="nx">top</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<p>即：每两次重绘（即每两次调用 <code>requestAnimationFrame()</code> ）之间，炮姐在每根轴上的移动距离是我和炮姐的间隔 × 0.002，直至我和炮姐的距离小于 100 像素，函数返回不再追及。随着我和炮姐之间的距离逐渐变短，炮姐每次移动的距离也变小，实现了“减速”的效果，有兴趣的话可以研究一下这到底属于哪一种运动规律。<code>0.002</code> 这个参数决定了追逐的速度，越大越快，你可以自己修改这个值，也可以试试在每根轴上采用不同的追逐速度。</p>
<p>说到这里我想到一件事。在工业设计领域，遇到直线与圆角连接时一般要保证连接点两边二阶导数连续才能算“平滑”。例如 iPhoneX 的显示界面圆角，并不是圆弧与直线连接，而是特别设计的弧，使得它在与直线的连接处足够平滑。不过这是题外话了。</p>
</div>
        
        <div class="prism-action-bar">
            <div class="comment-action action-item"><a class="no-link text-uppercase" href="/archives/171/#prism__comment" target="_self"><i class="fa fa-comment"></i>评论</a></div>
        </div>
        
    </article>
    
    <article class="yue prism-post-item col-md-8 offset-md-2">
        <h1 class="prism-post-title"><a class="no-link" href="/archives/169/" target="_self">一些 Typecho 开发笔记</a></h1>
        <div class="prism-post-time">
            <a class="no-link" href="/archives/169/" target="_self">
                <time class="text-uppercase">
                    October 18 2018
                </time>
            </a>
        </div>
        <div class="prism-content"><p>最近做了两个主题，一个是 <a href="https://github.com/AlanDecode/Typecho-Theme-RAW">Typecho-Theme-RAW</a>，另一个就是现在使用的这个，Typecho-Theme-Q。RAW 是我的 Typecho 主题第一作，象征意义比较大一点，主题质量各方面只能算差强人意吧。Q 的起源是因为我觉得 Bootstrap 有点意思，边看文档边写就写出来了，由于有写 RAW 时积累的经验加持，完成得很快。某些经验性质的东西不写下来很快就会忘，所以有了这一篇备忘。</p>
<blockquote><p>以下部分内容来自 <a href="https://qqdie.com">QQ 爹博客</a>等大佬的博文，在此先行感谢。</p>
</blockquote>
<h2>Typecho 配置</h2>
<h3>TYPECHO_DEBUG</h3>
<p>可在 Typecho 根目录下 <code>config.inc.php</code> 中添加以下代码来开启 DEBUG 模式。</p>
<div class="highlight"><pre><span></span><span class="x">define(&#39;__TYPECHO_DEBUG__&#39;, true);</span>
</pre></div>
<p>这个模式下会打印更多的报错信息，某些普通情况直接 500 处理的错误在这里会打印出错误原因与调用堆栈等，很有用。</p>
<h3>TYPECHO_GRAVATR_PREFIX</h3>
<p>这个常量可以修改 GRAVATAR 头像链接的前缀，方便使用国内镜像来加快速度。</p>
<div class="highlight"><pre><span></span><span class="x">define(&#39;__TYPECHO_GRAVATR_PREFIX__&#39;, &#39;https://gravatar.cat.net/avatar&#39;);</span>
</pre></div>
<p>需要注意的是要生效的话需要在主题中使用 Typecho 提供的方法来获取头像链接。</p>
<h3>主题层面修改 Typecho 设置</h3>
<p>在 PJAX 中评论失效的问题需要关闭主题的反垃圾保护，在主题中可以自动做到这一点。在主题目录下 <code>functions.php</code> 中创建如下代码即可。</p>
<div class="highlight"><pre><span></span><span class="x">function themeInit($archive){</span>
<span class="x">    Helper::options()-&gt;commentsAntiSpam = false; </span>
<span class="x">}</span>
</pre></div>
<p>Typecho 系统设置均可使用 <code>Helper::options()</code> 函数获取，权限蛮高的。另：<code>themeInit()</code> 函数完成了主题初始化，创建表之类的操作可以在这个函数中完成。</p>
<h2>主题开发</h2>
<h3>自定义渲染方式</h3>
<p>分别创建 <code>category</code>，<code>page</code>，<code>post</code> 文件夹，在其中创建 <code>分类缩略名.php</code>、<code>页面slug.php</code>、<code>文章cid.php</code> 即可覆盖默认的渲染方式来为某分类、页面、文章创建自定义渲染方式。</p>
<h3>主题设置面板</h3>
<p>在主题根目录下创建 <code>functions.php</code>，在其中定义函数 <code>themeConfig($form)</code></p>
<div class="highlight"><pre><span></span><span class="x">function themeConfig($form) {</span>
<span class="x">    //基本设置</span>
<span class="x">    $notice = new Typecho_Widget_Helper_Form_Element_Textarea(&#39;notice&#39;, NULL, NULL, _t(&#39;网站公告&#39;), _t(&#39;网站公告&#39;));</span>
<span class="x">    $form-&gt;addInput($notice);</span>
<span class="x">    $banner = new Typecho_Widget_Helper_Form_Element_Text(&#39;banner&#39;, NULL, NULL, _t(&#39;网站公告&#39;), _t(&#39;网站公告&#39;));</span>
<span class="x">    $form-&gt;addInput($banner);</span>
<span class="x">}</span>
</pre></div>
<p>类似这样就可以添加 Textarea 或者 Text 类型的输入框。其中的内容在主题中可以通过以下方式来访问。</p>
<div class="highlight"><pre><span></span><span class="x">$this-&gt;options-&gt;ValueName</span>
</pre></div>
<h3>文章自定义字段面板</h3>
<p>在主题根目录下创建 <code>functions.php</code>，在其中定义函数</p>
<div class="highlight"><pre><span></span><span class="x">function themeFields(Typecho_Widget_Helper_Layout $layout) {</span>
<span class="x">    $thumb = new Typecho_Widget_Helper_Form_Element_Textarea(&#39;banner&#39;, NULL, NULL, &#39;文章主图&#39;, &#39;输入图片URL，该图片会用于主页文章列表的显示&#39;);</span>
<span class="x">    $layout-&gt;addItem($thumb);</span>
<span class="x">    $showTOC=new Typecho_Widget_Helper_Form_Element_Select(&#39;showTOC&#39;,array(&#39;0&#39;=&gt;&#39;不显示目录&#39;,&#39;1&#39;=&gt;&#39;显示目录&#39;),&#39;0&#39;,&#39;文章目录&#39;,&#39;是否显示文章目录&#39;);</span>
<span class="x">    $layout-&gt;addItem($showTOC);</span>
<span class="x">}</span>
</pre></div>
<p>与上面相似，这样就可以为自定义字段创建友好的输入方式。这与手动添加自定义字段是等效的，但是可以提高使用体验。</p>
<h3>自定义评论输出方式</h3>
<p>创建 <code>comments.php</code> 文件，require 在 <code>functions.php</code> 中，然后就可以在其中重载输出评论的方式。</p>
<h3>Typecho 内建函数</h3>
<div class="highlight"><pre><span></span><span class="x">$this-&gt;header();</span>
</pre></div>
<p>这个函数要在 <code>head</code> 标签中调用，负责输出 RSS、Pingback 等信息，还涉及输出插件要在 <code>head</code> 中输出的内容。与上面的类似，不过一般在 <code>footer</code> 标签后调用：</p>
<div class="highlight"><pre><span></span><span class="x">$this-&gt;footer();</span>
</pre></div>
<p>获取所有设置：</p>
<div class="highlight"><pre><span></span><span class="x">Helper::options();</span>
</pre></div>
<p>获取某插件设置：</p>

<pre><code>Helper::options()-&gt;plugin($pluginName);</code></pre>
<h2>常用代码片段</h2>
<h3>博客内容统计</h3>
<div class="highlight"><pre><span></span><span class="cp">&lt;?php</span> <span class="nx">Typecho_Widget</span><span class="o">::</span><span class="na">widget</span><span class="p">(</span><span class="s1">&#39;Widget_Stat&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">to</span><span class="p">(</span><span class="nv">$stat</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">&lt;li&gt;文章总数：</span><span class="cp">&lt;?php</span> <span class="nv">$stat</span><span class="o">-&gt;</span><span class="na">publishedPostsNum</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x">篇&lt;/li&gt;</span>
<span class="x">&lt;li&gt;分类总数：</span><span class="cp">&lt;?php</span> <span class="nv">$stat</span><span class="o">-&gt;</span><span class="na">categoriesNum</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x">个&lt;/li&gt;</span>
<span class="x">&lt;li&gt;评论总数：</span><span class="cp">&lt;?php</span> <span class="nv">$stat</span><span class="o">-&gt;</span><span class="na">publishedCommentsNum</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x">条&lt;/li&gt;</span>
<span class="x">&lt;li&gt;页面总数：</span><span class="cp">&lt;?php</span> <span class="nv">$stat</span><span class="o">-&gt;</span><span class="na">publishedPagesNum</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x">个&lt;/li&gt;</span>
</pre></div>
<h3>输出当前文章为第几篇</h3>
<div class="highlight"><pre><span></span><span class="x">$this-&gt;sequence</span>
</pre></div>
<h3>最近评论</h3>
<div class="highlight"><pre><span></span><span class="x">$this-&gt;widget(&#39;Widget_Comments_Recent&#39;,&#39;ignoreAuthor=true&amp;pageSize=10&#39;)-&gt;to($comments);</span>
<span class="cp">&lt;?php</span> <span class="k">while</span><span class="p">(</span><span class="nv">$comments</span><span class="o">-&gt;</span><span class="na">next</span><span class="p">())</span><span class="o">:</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    </span><span class="cp">&lt;?php</span> <span class="nv">$comments</span><span class="o">-&gt;</span><span class="na">gravatar</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    &lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="nv">$comments</span><span class="o">-&gt;</span><span class="na">permalink</span><span class="p">();</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span><span class="cp">&lt;?php</span> <span class="nv">$comments</span><span class="o">-&gt;</span><span class="na">excerpt</span><span class="p">(</span><span class="nv">$num</span><span class="p">,</span> <span class="s1">&#39;...&#39;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&lt;/a&gt;</span>
<span class="cp">&lt;?php</span> <span class="k">endwhile</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
<p>其中 <code>ignoreAuthor=true</code> 可以过滤掉博主自己的评论。<code>pageSize</code> 为输出数量。</p>
<h3>Gravatar 头像链接</h3>
<div class="highlight"><pre><span></span><span class="x">Typecho_Common::gravatarUrl($mail, $size, &#39;&#39;, &#39;&#39;, true);</span>
</pre></div>
<p>可以根据邮箱地址给出头像链接。</p>
<h3>输出所有独立页面</h3>
<div class="highlight"><pre><span></span><span class="x">$this-&gt;widget(&#39;Widget_Contents_Page_List&#39;)-&gt;parse(&#39;&lt;li&gt;&lt;a href=&quot;{permalink}&quot; target=&quot;_self&quot;&gt;{title}&lt;/a&gt;&lt;/li&gt;&#39;);</span>
</pre></div>
<p><code>parse</code> 方法可以非常方便地格式化输出所有的独立页面，太帅了。</p>
<h3>文章、评论分页</h3>
<div class="highlight"><pre><span></span><span class="x">$this-&gt;pageNav(&#39;上一页&#39;, &#39;下一页&#39;, 0, &#39;&#39;, &#39;wrapClass=hidden&amp;prevClass=prev&amp;nextClass=next&#39;);</span>
</pre></div>
<h3>判断插件是否可用</h3>
<p>这是一个小坑。只要启用过插件，即使已经禁用了插件，<code>class_exsist()</code> 仍然会返回 <code>true</code>，所以应该如下检验：</p>
<div class="highlight"><pre><span></span><span class="x">/**</span>
<span class="x"> * 判断插件是否存在并启用</span>
<span class="x"> * </span>
<span class="x"> * @return boolean</span>
<span class="x"> */</span>
<span class="x">function isPluginAvailable($name) {</span>
<span class="x">    if (class_exists($name.&#39;_Plugin&#39;)){</span>
<span class="x">        $plugins = Typecho_Plugin::export();</span>
<span class="x">        $plugins = $plugins[&#39;activated&#39;];</span>
<span class="x">        return is_array($plugins) &amp;&amp; array_key_exists($name, $plugins);</span>
<span class="x">    }</span>
<span class="x">    return false;</span>
<span class="x">}</span>
</pre></div>
<h3>校验请求是否来自手机</h3>
<div class="highlight"><pre><span></span><span class="x">/**</span>
<span class="x"> * 手机识别</span>
<span class="x"> * </span>
<span class="x"> * @return boolean</span>
<span class="x"> */</span>
<span class="x">function isPhone(){</span>
<span class="x">    $ua=strtolower($_SERVER[&quot;HTTP_USER_AGENT&quot;]);</span>
<span class="x">    $devices=array(&quot;Android&quot;, &#39;iPhone&#39;, &#39;iPod&#39;, &#39;Phone&#39;);</span>
<span class="x">    foreach ($devices as $device) {</span>
<span class="x">        if(strpos($ua, strtolower($device))){</span>
<span class="x">            return true;</span>
<span class="x">        }</span>
<span class="x">    }</span>
<span class="x">    return false;</span>
<span class="x">}</span>
</pre></div>
<h3>校验请求是否来自移动设备</h3>
<div class="highlight"><pre><span></span><span class="x">/**</span>
<span class="x"> * 移动端判定</span>
<span class="x"> * </span>
<span class="x"> * @return bool</span>
<span class="x"> */</span>
<span class="x">public static function isMobile(){ </span>
<span class="x">    if (isset ($_SERVER[&#39;HTTP_X_WAP_PROFILE&#39;])){</span>
<span class="x">        return TRUE;</span>
<span class="x">    }</span>

<span class="x">    if (isset ($_SERVER[&#39;HTTP_USER_AGENT&#39;])) {</span>
<span class="x">        $clientkeywords = array (&#39;mobile&#39;,&#39;nokia&#39;,&#39;sony&#39;,&#39;ericsson&#39;,&#39;mot&#39;,&#39;samsung&#39;,&#39;htc&#39;,&#39;sgh&#39;,&#39;lg&#39;,&#39;sharp&#39;,&#39;sie-&#39;,&#39;philips&#39;,&#39;panasonic&#39;,&#39;alcatel&#39;,&#39;lenovo&#39;,&#39;iphone&#39;,&#39;ipod&#39;,&#39;blackberry&#39;,&#39;meizu&#39;,&#39;android&#39;,&#39;netfront&#39;,&#39;symbian&#39;,&#39;ucweb&#39;,&#39;windowsce&#39;,&#39;palm&#39;,&#39;operamini&#39;,&#39;operamobi&#39;,&#39;openwave&#39;,&#39;nexusone&#39;,&#39;cldc&#39;,&#39;midp&#39;,&#39;wap&#39;</span>
<span class="x">            ); </span>
<span class="x">        if (preg_match(&quot;/(&quot; . implode(&#39;|&#39;, $clientkeywords) . &quot;)/i&quot;, strtolower($_SERVER[&#39;HTTP_USER_AGENT&#39;]))){</span>
<span class="x">            return TRUE;</span>
<span class="x">        }</span>
<span class="x">    }</span>
<span class="x">    if (isset ($_SERVER[&#39;HTTP_ACCEPT&#39;])){</span>
<span class="x">        if ((strpos($_SERVER[&#39;HTTP_ACCEPT&#39;], &#39;vnd.wap.wml&#39;) !== FALSE) &amp;&amp; (strpos($_SERVER[&#39;HTTP_ACCEPT&#39;], &#39;text/html&#39;) === FALSE || (strpos($_SERVER[&#39;HTTP_ACCEPT&#39;], &#39;vnd.wap.wml&#39;) &lt; strpos($_SERVER[&#39;HTTP_ACCEPT&#39;], &#39;text/html&#39;)))){</span>
<span class="x">            return TRUE;</span>
<span class="x">        }</span>
<span class="x">    }</span>
<span class="x">    return FALSE;</span>
<span class="x">}</span>
</pre></div>
<h3>输出完备的文章标题</h3>
<p>一般是处于 SEO 之用</p>
<div class="highlight"><pre><span></span><span class="x">/**</span>
<span class="x"> * 导出标题</span>
<span class="x"> * </span>
<span class="x"> * @return void</span>
<span class="x"> */</span>
<span class="x">function title(Widget_Archive $archive){</span>
<span class="x">    $archive-&gt;archiveTitle(array(</span>
<span class="x">        &#39;category&#39;  =&gt;  _t(&#39;分类 %s 下的文章&#39;),</span>
<span class="x">        &#39;search&#39;    =&gt;  _t(&#39;包含关键字 %s 的文章&#39;),</span>
<span class="x">        &#39;tag&#39;       =&gt;  _t(&#39;标签 %s 下的文章&#39;),</span>
<span class="x">        &#39;author&#39;    =&gt;  _t(&#39;%s 发布的文章&#39;)</span>
<span class="x">    ), &#39;&#39;, &#39; - &#39;);</span>
<span class="x">    Helper::options()-&gt;title();</span>
<span class="x">}</span>
</pre></div>
<h3>面包屑导航</h3>
<p>用以输出当前位置相对主页的路由。</p>
<div class="highlight"><pre><span></span><span class="cp">&lt;?php</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">))</span><span class="o">:</span> <span class="cp">?&gt;</span><span class="x">&lt;!-- 页面为首页时 --&gt;</span>
<span class="x">    文章列表 &amp;raquo; 第&amp;nbsp;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_currentPage</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&amp;nbsp;页</span>
<span class="cp">&lt;?php</span> <span class="k">elseif</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">))</span><span class="o">:</span> <span class="cp">?&gt;</span><span class="x">&lt;!-- 页面为文章单页时 --&gt;</span>
<span class="x">    文章 &amp;raquo; </span><span class="cp">&lt;?php</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">title</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="cp">&lt;?php</span> <span class="k">else</span><span class="o">:</span> <span class="cp">?&gt;</span><span class="x">&lt;!-- 页面为其他页时 --&gt;</span>
<span class="cp">&lt;?php</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">archiveTitle</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;category&#39;</span>  <span class="o">=&gt;</span>  <span class="nx">_t</span><span class="p">(</span><span class="s1">&#39;分类 &quot;%s&quot; 下的文章&#39;</span><span class="p">),</span>
    <span class="s1">&#39;search&#39;</span>    <span class="o">=&gt;</span>  <span class="nx">_t</span><span class="p">(</span><span class="s1">&#39;包含关键字 &quot;%s&quot; 的文章&#39;</span><span class="p">),</span>
    <span class="s1">&#39;tag&#39;</span>       <span class="o">=&gt;</span>  <span class="nx">_t</span><span class="p">(</span><span class="s1">&#39;标签 &quot;%s&quot; 下的文章&#39;</span><span class="p">),</span>
    <span class="s1">&#39;author&#39;</span>    <span class="o">=&gt;</span>  <span class="nx">_t</span><span class="p">(</span><span class="s1">&#39;%s 发布的文章&#39;</span><span class="p">)</span>
<span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="cp">&lt;?php</span> <span class="k">endif</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
<h3>某些可以简化工作量的函数</h3>
<div class="highlight"><pre><span></span><span class="x">$this-&gt;options-&gt;themeUrl(&#39;/some/path/&#39;); //输出相对主题目录的路径</span>
<span class="x">Helper::options()-&gt;pluginUrl; //获取插件目录</span>
<span class="x">Helper::options()-&gt;index(&#39;/some/path/&#39;); //输出相对博客根目录的路径</span>
</pre></div>
<h2>数据库相关</h2>
<h3>根据 CID 调用文章</h3>
<div class="highlight"><pre><span></span><span class="x">$db = Typecho_Db::get();</span>
<span class="x">$row = $db-&gt;fetchRow($db-&gt;select()-&gt;from(&#39;table.contents&#39;)-&gt;where(&#39;cid = ?&#39;, $cid));</span>
</pre></div>
<p><code>$row</code> 为 Array，包括了文章本题的许多字段，包括 <code>title</code>、创建日期等。</p>
<h3>获得某文章的某自定义字段</h3>
<div class="highlight"><pre><span></span><span class="x">$row = $db-&gt;fetchAll($db-&gt;select()-&gt;from(&#39;table.fields&#39;)-&gt;where(&#39;cid = ?&#39;, $cid)-&gt;where(&#39;name = ?&#39;, $fieldName));</span>
<span class="x">$field=$row[0][&#39;str_value&#39;];</span>
</pre></div>
<p>数据库相关属于比较高级的用法了，虽然在某些时候不得不用，但是最好还是使用 Typecho 提供的更原生的方法。更多：<a href="https://qqdie.com/archives/typecho-database-api.html">Typecho数据库常用API</a> 。</p>
<p>暂时就这些，后续想到再添加。</p>
</div>
        
        <div class="prism-action-bar">
            <div class="comment-action action-item"><a class="no-link text-uppercase" href="/archives/169/#prism__comment" target="_self"><i class="fa fa-comment"></i>评论</a></div>
        </div>
        
    </article>
    
</section>

<div class="container">
    <section id="prism__page__pagination" class="prism-pagination" class="col-md-8 offset-md-2">
        <ul>
            
            <li class="next">
                <a class="no-link" href="/page/4/" target="_self"><i class="fa fa-chevron-left" aria-hidden="true"></i>更新</a>
            </li>
            
            
            <li class="prev">
                <a class="no-link" href="/page/6/" target="_self">更旧<i class="fa fa-chevron-right" aria-hidden="true"></i></a>
            </li>
            
        </ul>
    </section>
</div>


</main>

            <footer id="prism__footer">
                <section>
                    <div>
                        <nav class="social-links">
                            <ul><li><a class="no-link" title="Twitter" href="https://twitter.com/AlanDecode" target="_blank" rel="noopener noreferrer nofollow"><i class="gi gi-twitter"></i></a></li><li><a class="no-link" title="GitHub" href="https://github.com/AlanDecode" target="_blank" rel="noopener noreferrer nofollow"><i class="gi gi-github"></i></a></li><li><a class="no-link" title="Weibo" href="https://weibo.com/5245109677/" target="_blank" rel="noopener noreferrer nofollow"><i class="gi gi-weibo"></i></a></li></ul>
                        </nav>
                    </div>

                    <section id="prism__external_links">
                        <ul>
                            
                            <li>
                                <a class="no-link" target="_blank" href="https://github.com/AlanDecode/Maverick" rel="noopener noreferrer nofollow">Maverick</a>：🏄‍ Go My Own Way.
                                <span>|</span>
                            </li>
                            
                            <li>
                                <a class="no-link" target="_blank" href="https://www.imalan.cn" rel="noopener noreferrer nofollow">三無計劃</a>：三是虚指。至于是哪三无，我唔知。
                                <span>|</span>
                            </li>
                            
                            <li>
                                <a class="no-link" target="_blank" href="https://wiki.imalan.cn" rel="noopener noreferrer nofollow">無知識</a>：熊猫小A的Wiki站点。隶属于「三无计划」。
                                <span>|</span>
                            </li>
                            
                            <li>
                                <a class="no-link" target="_blank" href="https://lab.imalan.cn" rel="noopener noreferrer nofollow">無項目</a>：熊猫小A的实验室。隶属于「三无计划」。
                                <span>|</span>
                            </li>
                            
                            <li>
                                <a class="no-link" target="_blank" href="https://t.me/triple_null" rel="noopener noreferrer nofollow">無消息</a>：熊猫小A的广播。隶属于「三无计划」。
                                <span>|</span>
                            </li>
                            
                        </ul>
                    </section>

                    <div class="copyright">
                        <p class="copyright-text">
                            <span class="brand">无文字 | 三无计划</span>
                            <span>Copyright © 2020 熊猫小A</span>
                        </p>
                        <p class="copyright-text powered-by">
                            | Powered by <a href="https://github.com/AlanDecode/Maverick" class="no-link" target="_blank" rel="noopener noreferrer nofollow">Maverick</a> | Theme <a href="https://github.com/Reedo0910/Maverick-Theme-Prism" target="_blank" class="no-link" rel="noopener noreferrer nofollow">Prism</a>
                        </p>
                    </div>
                    <div class="footer-addon">
                        
<a no-style href="http://beian.miit.gov.cn" target="_blank">京ICP备18000133号-1</a> | 
<a no-style href="https://www.upyun.com" target="_blank">又拍云</a>

                    </div>
                </section>
                <script>
                    var site_build_date = "2017-06-29T12:00+08:00"

                </script>
                <script src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/assets/prism-a1bd79b1a4.js"></script>
            </footer>
        </div>
    </div>
    </div>

    <script src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/assets/ExSearch/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/assets/ExSearch/ExSearch-493cb9cd89.js"></script>

    <!--katex-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/assets/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/assets/katex.min.js"></script>
    <script>
        mathOpts = {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "\\[", right: "\\]", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false }
            ]
        };

    </script>
    <script defer src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/assets/auto-render.min.js" onload="renderMathInElement(document.body, mathOpts);"></script>

    
<script>
    var _hmt = _hmt || [];
    (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?e4f3a7c02ac2aabc41a1cfa95f61a026";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
    })();
</script>
<script>
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>
<script>
if(window.location.hash){
    var checkExist = setInterval(function() {
       if ($(window.location.hash).length) {
          $('html, body').animate({scrollTop: $(window.location.hash).offset().top-90}, 1000);
          clearInterval(checkExist);
       }
    }, 100);
}
</script>
<script>
if(window.navigator && navigator.serviceWorker) {
  caches.keys().then(function(cacheNames) {
    cacheNames.forEach(function(cacheName) {
      caches.delete(cacheName);
    });
  }).then(function(){
    console.log('Cache cleaned.');
  });
  navigator.serviceWorker.getRegistrations()
  .then(function(registrations) {
    for(let registration of registrations) {
      registration.unregister();
    }
  }).then(function(){
    console.log('Service Worker stopped.');
  });
}
</script>

</body>

</html>